<view class="container">
  <!-- è½®æ’­å›¾åŒºåŸŸ -->
  <view class="swiper-container">
    <swiper class="banner-swiper" indicator-dots="true" autoplay="true" interval="5000" duration="500" indicator-color="rgba(255,255,255,0.5)" indicator-active-color="#fff" circular>
      <block wx:for="{{banners}}" wx:key="id">
        <swiper-item bindtap="onBannerTap" data-index="{{index}}">
          <image src="{{item.imageUrl}}" class="banner-image" mode="aspectFill"></image>
        </swiper-item>
      </block>
    </swiper>
  </view>

  <!-- å¿«æ·å…¥å£ (é‡‘åˆšåŒº) -->
  <view class="shortcut-grid card-box">
    <block wx:for="{{shortcuts}}" wx:key="name">
      <view class="shortcut-item" bindtap="onShortcutTap" data-path="{{item.path}}" hover-class="hover-opacity">
        <view class="shortcut-icon">{{item.icon}}</view>
        <text class="shortcut-text">{{item.name}}</text>
      </view>
    </block>
  </view>

  <!-- æ ¡å›­å…¬å‘Š -->
  <view class="announcement-bar card-box">
    <view class="announcement-label">
      <text class="label-icon">ğŸ””</text>
      <text class="label-text">å…¬å‘Š</text>
    </view>
    <swiper class="announcement-swiper" autoplay="true" vertical="true" interval="3000" circular>
      <block wx:for="{{announcements}}" wx:key="id">
        <swiper-item class="announcement-swiper-item" bindtap="onAnnouncementTap" data-id="{{item.id}}">
          <text class="announcement-text ellipsis">{{item.title}}</text>
        </swiper-item>
      </block>
    </swiper>
    <text class="arrow">></text>
  </view>

  <!-- é™¢ç³»é£é‡‡ -->
  <view class="section-container">
    <view class="section-header">
      <text class="section-title">é™¢ç³»é£é‡‡</text>
    </view>
    <scroll-view class="department-scroll" scroll-x="true" enable-flex="true">
      <block wx:for="{{departments}}" wx:key="id">
        <view class="department-card" style="background-color: {{item.color}}" bindtap="onDepartmentTap" data-id="{{item.id}}">
          <view class="dept-icon">{{item.icon}}</view>
          <view class="dept-info">
            <text class="dept-name">{{item.name}}</text>
            <text class="dept-desc">{{item.desc}}</text>
          </view>
        </view>
      </block>
    </scroll-view>
  </view>

  <!-- èµ„è®¯åˆ—è¡¨ -->
  <view class="news-section">
    <view class="section-header">
      <text class="section-title">æ ¡å›­èµ„è®¯</text>
      <text class="section-more">æŸ¥çœ‹æ›´å¤š</text>
    </view>
    <view class="news-list">
      <block wx:for="{{newsList}}" wx:key="id">
        <view class="news-card card-box" bindtap="onNewsTap" data-id="{{item.id}}" hover-class="hover-opacity">
          <view class="news-info">
            <text class="news-title ellipsis-2">{{item.title}}</text>
            <view class="news-meta">
              <text>{{item.date}}</text>
              <text class="news-view">ğŸ‘ {{item.viewCount}}</text>
            </view>
          </view>
          <image class="news-cover" src="{{item.coverUrl}}" mode="aspectFill"></image>
        </view>
      </block>
    </view>
  </view>

  <!-- AIæ•°å­—äººæ‚¬æµ®çƒ -->
  <view class="ai-avatar-float" bindtap="toggleChat">
    <view class="avatar-pulse"></view>
    <view class="avatar-img">ğŸ‘©â€ğŸ“</view>
    <view class="avatar-label">AIåŠ©æ‰‹</view>
  </view>

  <!-- AIèŠå¤©å¼¹çª— -->
  <view class="chat-modal {{showChat ? 'show' : ''}}" catchtouchmove="preventTouchMove">
    <view class="chat-mask" bindtap="toggleChat"></view>
    <view class="chat-container">
      <view class="chat-header">
        <text class="chat-title">æ ¡å›­AIåŠ©æ‰‹</text>
        <view class="close-btn" bindtap="toggleChat">Ã—</view>
      </view>
      <scroll-view class="chat-content" scroll-y="true" scroll-into-view="{{scrollIntoView}}">
        <block wx:for="{{chatMessages}}" wx:key="index">
          <view class="message-item {{item.role === 'user' ? 'user-msg' : 'ai-msg'}}" id="msg-{{index}}">
            <view class="msg-avatar" wx:if="{{item.role === 'ai'}}">ğŸ‘©â€ğŸ“</view>
            <view class="msg-bubble">
              <text user-select="true">{{item.content}}</text>
            </view>
            <view class="msg-avatar" wx:if="{{item.role === 'user'}}">ğŸ‘¤</view>
          </view>
        </block>
        <view class="loading-msg" wx:if="{{isAiTyping}}">
          <view class="dot"></view><view class="dot"></view><view class="dot"></view>
        </view>
      </scroll-view>
      <view class="floatmax">
        <view class="kkk">æœ¬æœåŠ¡ä¸ºAIç”Ÿæˆå†…å®¹ï¼Œç»“æœä»…ä¾›å‚è€ƒ</view>
        <view class="chat-footer">
        <input class="chat-input" placeholder="é—®é—®æˆ‘å…³äºæ ¡å›­çš„äº‹..." value="{{inputVal}}" bindinput="onChatInput" bindconfirm="sendChatMessage" confirm-type="send"/>
        <view class="send-btn" bindtap="sendChatMessage" disabled="{{!inputVal}}">
            <image src="/images/play.png" class="buttonplay" mode=""></image>
        </view>
      </view>
      
      </view>
     
    </view>
  </view>
</view>